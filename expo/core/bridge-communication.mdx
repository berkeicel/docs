---
title: "Bridge Communication"
description: "WebView â†” Native message passing and variable synchronization"
---

RampKit uses a bridge between your onboarding content and native code for seamless communication.

## Sending Messages to Native

Use `window.ReactNativeWebView.postMessage()` from your onboarding content:

```javascript
// Simple string message
window.ReactNativeWebView.postMessage('continue');

// JSON payload
window.ReactNativeWebView.postMessage(JSON.stringify({
  type: 'rampkit:navigate',
  targetScreenId: 'screen_2',
  animation: 'fade'
}));
```

## Supported Actions

### Navigation

```javascript
// Continue to next screen
{ type: 'rampkit:continue', animation: 'fade' | 'slide' | 'slideFade' }

// Navigate to specific screen
{ type: 'rampkit:navigate', targetScreenId: 'screen_id', animation: '...' }

// Go back
{ type: 'rampkit:goBack', animation: '...' }

// Close onboarding
{ type: 'rampkit:close' }

// Complete onboarding
{ type: 'rampkit:onboarding-finished', payload: { ... } }
```

### Variables

```javascript
// Update shared variables
{
  type: 'rampkit:variables',
  vars: {
    selectedGoal: 'weight_loss',
    selectedPlan: 'premium'
  }
}
```

### Haptics

```javascript
// Trigger haptic feedback
{
  type: 'rampkit:haptic',
  action: 'haptic',
  hapticType: 'impact' | 'notification' | 'selection',
  impactStyle: 'Light' | 'Medium' | 'Heavy',
  notificationType: 'Success' | 'Warning' | 'Error'
}
```

### System Actions

```javascript
// Request store review
{ type: 'rampkit:request-review' }

// Request notification permissions
{ type: 'rampkit:request-notification-permission' }

// Show paywall
{ type: 'rampkit:show-paywall', payload: { productId: 'pro_monthly' } }
```

## Receiving Updates

Listen for variable updates in your onboarding content:

```javascript
// Variables are available globally
const goal = window.__rampkitVariables?.selectedGoal;

// Listen for updates
document.addEventListener('rampkit:vars-updated', (event) => {
  const vars = event.detail;
  console.log('Variables updated:', vars);
  updateUI(vars);
});
```

## Device Context

Device and user context is available:

```javascript
const ctx = window.rampkitContext;

console.log(ctx.device.platform);      // "iOS"
console.log(ctx.device.currencyCode);  // "USD"
console.log(ctx.user.isNewUser);       // true
```

## Notification Permission Flow

```javascript
// Request permission
window.ReactNativeWebView.postMessage(JSON.stringify({
  type: 'rampkit:request-notification-permission'
}));

// Result is stored in variables
document.addEventListener('rampkit:vars-updated', (event) => {
  const { notificationsPermission } = event.detail;
  if (notificationsPermission) {
    console.log('Granted:', notificationsPermission.granted);
  }
});
```

<Warning>
Always stringify JSON payloads before posting. The bridge expects string messages only.
</Warning>
